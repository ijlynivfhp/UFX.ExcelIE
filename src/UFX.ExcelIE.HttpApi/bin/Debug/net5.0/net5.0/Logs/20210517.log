{"Timestamp":"2021-05-17T16:58:08.2204770+08:00","Level":"Information","MessageTemplate":"Starting the processing server.","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":1,"ProcessId":23408,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T16:58:08.3600480+08:00","Level":"Information","MessageTemplate":"### CAP started!","Properties":{"SourceContext":"DotNetCore.CAP.Internal.Bootstrapper","MachineName":"ABC","ThreadId":1,"ProcessId":23408,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T16:58:08.5221370+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-YRDe29U6Y2hh_V-sx7qPUg","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":15,"ProcessId":23408,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:20:40.9151807+08:00","Level":"Information","MessageTemplate":"Shutting down the processing server...","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":37,"ProcessId":23408,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:20:40.9154163+08:00","Level":"Information","MessageTemplate":"### CAP shutdown!","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":37,"ProcessId":23408,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:22:03.1366761+08:00","Level":"Information","MessageTemplate":"Starting the processing server.","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":1,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:22:03.2700371+08:00","Level":"Information","MessageTemplate":"### CAP started!","Properties":{"SourceContext":"DotNetCore.CAP.Internal.Bootstrapper","MachineName":"ABC","ThreadId":1,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:22:03.4100852+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-ExeehLdVa0C-ltVozdN12A","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":14,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:22:11.8634022+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/","StatusCode":301,"Elapsed":108.1057,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994M:00000002","ConnectionId":"0HM8P2L08994M","MachineName":"ABC","ThreadId":17,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"108.1057"}]}}
{"Timestamp":"2021-05-17T17:22:11.8782283+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/index.html","StatusCode":200,"Elapsed":2.2514,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994M:00000003","ConnectionId":"0HM8P2L08994M","MachineName":"ABC","ThreadId":17,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"2.2514"}]}}
{"Timestamp":"2021-05-17T17:22:11.9245990+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/knife4j/js/app.d4cb69c0.js","StatusCode":200,"Elapsed":19.3544,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994N:00000002","ConnectionId":"0HM8P2L08994N","MachineName":"ABC","ThreadId":23,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"19.3544"}]}}
{"Timestamp":"2021-05-17T17:22:11.9265556+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/knife4j/css/app.8efd8010.css","StatusCode":200,"Elapsed":21.3258,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994M:00000004","ConnectionId":"0HM8P2L08994M","MachineName":"ABC","ThreadId":14,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"21.3258"}]}}
{"Timestamp":"2021-05-17T17:22:11.9416659+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/knife4j/js/chunk-vendors.e86fea24.js","StatusCode":200,"Elapsed":36.418,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994O:00000002","ConnectionId":"0HM8P2L08994O","MachineName":"ABC","ThreadId":16,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"36.4180"}]}}
{"Timestamp":"2021-05-17T17:22:12.8316418+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/favicon.ico","StatusCode":200,"Elapsed":0.4459,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994O:00000003","ConnectionId":"0HM8P2L08994O","MachineName":"ABC","ThreadId":21,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"0.4459"}]}}
{"Timestamp":"2021-05-17T17:22:12.8906287+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/v3/api-docs/swagger-config","StatusCode":200,"Elapsed":59.2254,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994M:00000005","ConnectionId":"0HM8P2L08994M","MachineName":"ABC","ThreadId":25,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"59.2254"}]}}
{"Timestamp":"2021-05-17T17:22:13.1822954+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"GET","RequestPath":"/v1/api-docs","StatusCode":200,"Elapsed":260.545,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994M:00000006","ConnectionId":"0HM8P2L08994M","MachineName":"ABC","ThreadId":25,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"260.5450"}]}}
{"Timestamp":"2021-05-17T17:26:38.5270518+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"UFX_MASTERContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.0154289+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"33","parameters":"@__ieDto_TenantId_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [a].[TntCode], [a].[CreateTime], [a].[CreateUser], [a].[Id], [a].[ModifyTime], [a].[ModifyUser], [a].[RowVersion], [a].[TntContact], [a].[TntDbStr], [a].[TntDesc], [a].[TntEmail], [a].[TntExpire], [a].[TntName], [a].[TntPhone], [a].[TntPrice], [a].[TntUserLimit]\r\nFROM [AM_Tenant] AS [a]\r\nWHERE [a].[Id] = @__ieDto_TenantId_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.3681545+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":44,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.4859166+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"27","parameters":"@__ieDto_TemplateCode_0='?' (Size = 50)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[ExecMaxCountPer], [c].[ExecSQL], [c].[ExportHead], [c].[IsDelete], [c].[MainTableSign], [c].[ModifyTime], [c].[ModifyUser], [c].[OrderField], [c].[RowVersion], [c].[Sort], [c].[SourceType], [c].[SourceUrl], [c].[Status], [c].[TemplateCode], [c].[TemplateName], [c].[TemplateType], [c].[TemplateUrl]\r\nFROM [CO_ExcelExportSQL] AS [c]\r\nWHERE [c].[TemplateCode] = @__ieDto_TemplateCode_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.6553052+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":2406.2931,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994P:00000002","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"2406.2931"}]}}
{"Timestamp":"2021-05-17T17:26:39.7890151+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000003","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.8198784+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@__ieDto_TemplateCode_0='?' (Size = 50)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[ExecMaxCountPer], [c].[ExecSQL], [c].[ExportHead], [c].[IsDelete], [c].[MainTableSign], [c].[ModifyTime], [c].[ModifyUser], [c].[OrderField], [c].[RowVersion], [c].[Sort], [c].[SourceType], [c].[SourceUrl], [c].[Status], [c].[TemplateCode], [c].[TemplateName], [c].[TemplateType], [c].[TemplateUrl]\r\nFROM [CO_ExcelExportSQL] AS [c]\r\nWHERE [c].[TemplateCode] = @__ieDto_TemplateCode_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000003","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.8300788+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.8353990+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:39.8570875+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":196.159,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994P:00000003","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"196.1590"}]}}
{"Timestamp":"2021-05-17T17:26:39.8727755+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:40.3493767+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"35","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:40.9661544+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":44,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.0190606+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"25","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.1830129+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.2539691+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.2999752+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.3000395+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.3131158+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":43,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.3391944+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.5836404+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.5974842+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.6109532+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:26:41.6401671+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":13,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.2955014+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000004","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.3151538+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":22.4478,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994P:00000004","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"22.4478"}]}}
{"Timestamp":"2021-05-17T17:27:15.3169802+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994P:00000005","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.3366611+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.3369902+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.4157445+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"72","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.4534706+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"20","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.4615575+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":145.5564,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994P:00000005","ConnectionId":"0HM8P2L08994P","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"145.5564"}]}}
{"Timestamp":"2021-05-17T17:27:15.7794494+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":49,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.7947340+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.8140713+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.8444680+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:15.8609651+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394222975040999424","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method609(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T17:27:16.6268973+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.6269437+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.6420797+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.6710720+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.7872696+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":49,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.7992829+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.8146823+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T17:27:16.8500424+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:20.6876330+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"UFX_MASTERContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994V:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994V","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:20.6941068+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"2","parameters":"@__ieDto_TenantId_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [a].[TntCode], [a].[CreateTime], [a].[CreateUser], [a].[Id], [a].[ModifyTime], [a].[ModifyUser], [a].[RowVersion], [a].[TntContact], [a].[TntDbStr], [a].[TntDesc], [a].[TntEmail], [a].[TntExpire], [a].[TntName], [a].[TntPhone], [a].[TntPrice], [a].[TntUserLimit]\r\nFROM [AM_Tenant] AS [a]\r\nWHERE [a].[Id] = @__ieDto_TenantId_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994V:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994V","MachineName":"ABC","ThreadId":68,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:20.7028496+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994V:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994V","MachineName":"ABC","ThreadId":68,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:20.7325876+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":53.6366,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994V:00000002","ConnectionId":"0HM8P2L08994V","MachineName":"ABC","ThreadId":68,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"53.6366"}]}}
{"Timestamp":"2021-05-17T18:05:20.7370307+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"c5cbc2f4-1a07-4dbf-864a-3045912e006a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P2L08994V:00000003","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P2L08994V","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:20.7651567+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":30.4549,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P2L08994V:00000003","ConnectionId":"0HM8P2L08994V","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"30.4549"}]}}
{"Timestamp":"2021-05-17T18:05:21.3207896+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":86,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:21.3210258+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":86,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:21.7145378+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:21.7510258+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"20","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":87,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.3344982+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":68,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.3509585+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"16","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.3679292+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.4175111+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"33","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.4337843+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394232560787247104","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method609(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\bin\\Debug\\net5.0\\net5.0\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T18:05:22.8184124+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.8187417+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.8383581+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"16","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:22.8715668+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"19","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:23.0530296+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:23.0676604+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:23.0866484+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"16","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":95,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:23.1255626+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"17","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":88,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:36.1066834+08:00","Level":"Information","MessageTemplate":"Shutting down the processing server...","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":87,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:36.1070176+08:00","Level":"Information","MessageTemplate":"### CAP shutdown!","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":87,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:36.1217489+08:00","Level":"Warning","MessageTemplate":"RabbitMQ consumer cancelled. --> amq.ctag-ExeehLdVa0C-ltVozdN12A","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":4,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:36.1218903+08:00","Level":"Warning","MessageTemplate":"RabbitMQ consumer shutdown. --> Goodbye","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":4,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:36.1256101+08:00","Level":"Warning","MessageTemplate":"RabbitMQ client connection closed! --> Connection close forced","Properties":{"SourceContext":"DotNetCore.CAP.RabbitMQ.ConnectionChannelPool","MachineName":"ABC","ThreadId":12,"ProcessId":32224,"ProcessName":"dotnet","EnvironmentUserName":"ABC\\Administrator"}}
