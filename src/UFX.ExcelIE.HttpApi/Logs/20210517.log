{"Timestamp":"2021-05-17T18:05:47.4929519+08:00","Level":"Information","MessageTemplate":"Starting the processing server.","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":1,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:47.7650288+08:00","Level":"Information","MessageTemplate":"### CAP started!","Properties":{"SourceContext":"DotNetCore.CAP.Internal.Bootstrapper","MachineName":"ABC","ThreadId":1,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:05:48.0325404+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-WMo6zYbXs0aIrqHEyWPDAQ","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:04.3903754+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:04.7811540+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":2598.0629,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJC:00000002","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"2598.0629"}]}}
{"Timestamp":"2021-05-17T18:06:04.8286312+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000003","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:05.0422328+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:05.0455212+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":221.9555,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJC:00000003","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":30,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"221.9555"}]}}
{"Timestamp":"2021-05-17T18:06:05.0480448+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:05.6890632+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"28","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:06.1775217+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"40","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":30,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:06.9446125+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":30,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.0111614+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"34","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.1596183+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.2056608+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"11","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":11,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.3378832+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394232745793728512","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method583(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":11,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T18:06:07.7106019+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.7107170+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.7255529+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"10","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.7489346+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.9180513+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:07.9321674+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:08.0159092+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"72","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:06:08.0558550+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"26","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":28,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.4091753+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"UFX_MASTERContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000004","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":11,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.4490284+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"3","parameters":"@__ieDto_TenantId_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [a].[TntCode], [a].[CreateTime], [a].[CreateUser], [a].[Id], [a].[ModifyTime], [a].[ModifyUser], [a].[RowVersion], [a].[TntContact], [a].[TntDbStr], [a].[TntDesc], [a].[TntEmail], [a].[TntExpire], [a].[TntName], [a].[TntPhone], [a].[TntPrice], [a].[TntUserLimit]\r\nFROM [AM_Tenant] AS [a]\r\nWHERE [a].[Id] = @__ieDto_TenantId_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000004","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.4646986+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000004","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.4936449+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"10","parameters":"@__ieDto_TemplateCode_0='?' (Size = 50)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[ExecMaxCountPer], [c].[ExecSQL], [c].[ExportHead], [c].[IsDelete], [c].[MainTableSign], [c].[ModifyTime], [c].[ModifyUser], [c].[OrderField], [c].[RowVersion], [c].[Sort], [c].[SourceType], [c].[SourceUrl], [c].[Status], [c].[TemplateCode], [c].[TemplateName], [c].[TemplateType], [c].[TemplateUrl]\r\nFROM [CO_ExcelExportSQL] AS [c]\r\nWHERE [c].[TemplateCode] = @__ieDto_TemplateCode_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000004","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":11,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.5139447+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":140.939,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJC:00000004","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"140.9390"}]}}
{"Timestamp":"2021-05-17T18:07:12.5165426+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000005","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":35,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.5314575+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__ieDto_TemplateCode_0='?' (Size = 50)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[ExecMaxCountPer], [c].[ExecSQL], [c].[ExportHead], [c].[IsDelete], [c].[MainTableSign], [c].[ModifyTime], [c].[ModifyUser], [c].[OrderField], [c].[RowVersion], [c].[Sort], [c].[SourceType], [c].[SourceUrl], [c].[Status], [c].[TemplateCode], [c].[TemplateName], [c].[TemplateType], [c].[TemplateUrl]\r\nFROM [CO_ExcelExportSQL] AS [c]\r\nWHERE [c].[TemplateCode] = @__ieDto_TemplateCode_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJC:00000005","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.5523010+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":36,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.5523544+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":36,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.5647046+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":49.8348,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJC:00000005","ConnectionId":"0HM8P3DG5RUJC","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"49.8348"}]}}
{"Timestamp":"2021-05-17T18:07:12.5689439+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":36,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.5968031+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"11","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:12.9633664+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.0084661+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.0216548+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"10","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.0431965+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"10","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.1596131+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394233029622280192","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method583(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T18:07:13.5378365+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.5379946+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.5502303+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"11","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.5759765+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.6801117+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.7142689+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"34","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.7285763+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:07:13.7627694+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.6702486+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJD:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJD","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.6922400+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":52.8147,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJD:00000002","ConnectionId":"0HM8P3DG5RUJD","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"52.8147"}]}}
{"Timestamp":"2021-05-17T18:08:58.6955787+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJD:00000003","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJD","MachineName":"ABC","ThreadId":35,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.7179194+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":34,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.7180118+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":34,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.7423263+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"23","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":34,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.8176595+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":34,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:08:58.8454454+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":152.4181,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJD:00000003","ConnectionId":"0HM8P3DG5RUJD","MachineName":"ABC","ThreadId":35,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"152.4181"}]}}
{"Timestamp":"2021-05-17T18:09:14.7215902+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:14.7921632+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"28","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:14.8121480+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"17","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:14.8438809+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:14.9327329+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394233474965090304","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method583(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T18:09:15.5276197+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:15.5279342+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:15.5425012+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:15.5945410+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"37","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:17.8576492+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:17.8767614+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"19","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:17.8904741+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:09:17.9127613+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:15.7156735+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJE:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:15.7438053+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":49.2422,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJE:00000002","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"49.2422"}]}}
{"Timestamp":"2021-05-17T18:11:15.7566672+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJE:00000003","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:15.7976223+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":49.1506,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJE:00000003","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"49.1506"}]}}
{"Timestamp":"2021-05-17T18:11:15.7992076+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":40,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:15.7992889+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":40,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:15.8199617+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"19","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":28,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:15.8447308+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"10","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:23.7663572+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:23.8233345+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:23.8421183+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"17","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:23.8744074+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"16","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:23.9859597+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394234049840590848","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method583(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T18:11:24.1857371+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:24.1858010+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:24.1990434+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:24.2245746+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"14","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":28,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:25.1827604+08:00","Level":"Information","MessageTemplate":"导入成功！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:25.1936271+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"11","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:25.2121796+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"17","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:11:25.2366225+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = -1) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:12:36.3327730+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJE:00000004","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:12:36.3782678+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":51.4708,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJE:00000004","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":28,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"51.4708"}]}}
{"Timestamp":"2021-05-17T18:12:36.4124662+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"d9943ff0-ddde-4920-a557-14404a2984c5","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8P3DG5RUJE:00000005","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:12:36.4360157+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:12:36.4364494+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:12:36.4655132+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":66.189,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8P3DG5RUJE:00000005","ConnectionId":"0HM8P3DG5RUJE","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"66.1890"}]}}
{"Timestamp":"2021-05-17T18:12:36.4923258+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"54","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:12:36.5248615+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"19","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:27.6015425+08:00","Level":"Error","MessageTemplate":"导入失败：Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:27.6648831+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:27.6852873+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:27.7211176+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"20","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:27.8117006+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394234388115402752","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\n ---> System.IO.FileNotFoundException: Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.\r\nFile name: 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'\r\n   at System.IO.FileStream.ValidateFileHandle(SafeFileHandle fileHandle)\r\n   at System.IO.FileStream.CreateFileOpenHandle(FileMode mode, FileShare share, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options)\r\n   at System.IO.FileStream..ctor(String path, FileMode mode)\r\n   at Magicodes.ExporterAndImporter.Excel.Utility.TemplateExport.TemplateExportHelper`1.Export(String templateFilePath, T data, Action`1 callback)\r\n   at Magicodes.ExporterAndImporter.Excel.ExcelExporter.ExportByTemplate[T](String fileName, T data, String template)\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 194\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 253\r\n   at lambda_method583(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":16,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"DotNetCore.CAP","InnerException":{"HResult":-2147024894,"Message":"Could not find file 'E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx'.","Source":"System.Private.CoreLib","FileName":"E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.HttpApi\\ExcelIE\\Template\\款式信息SKU.xlsx","FusionLog":null,"Type":"System.IO.FileNotFoundException"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-17T18:13:28.1982841+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:28.1987433+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":29,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:28.2145720+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":48,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-17T18:13:28.2402265+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"12","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = -1) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":48,"ProcessId":16716,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
