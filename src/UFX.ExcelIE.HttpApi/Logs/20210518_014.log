{"Timestamp":"2021-05-18T13:58:49.1500012+08:00","Level":"Information","MessageTemplate":"审计记录:{@info}","Properties":{"info":{"_typeTag":"AutoHistory","Id":"058a9568-5e30-811c-835f-39fc903b0638","ObjId":"88a20795-0c11-171d-43e9-39fc8fbef796","ObjName":"CO_ExcelExportSQLLog","Operate":"Modified","OldValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":\"http://localhost:8010/ExcelIE/\",\"ExecCount\":2,\"ExportCount\":208,\"ExportDurationQuery\":0.0,\"ExportDurationTask\":31.0,\"ExportDurationWrite\":9.0,\"ExportMsg\":\"导出成功：30.7436478秒\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":\";WITH MainSql AS (SELECT (CASE                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN                    B.ImgUrl                ELSE                    ''            END           ) AS ImgUrl,CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END AS Statuz,E.CfgValue AS FxStore,B.SmName AS SmName,B.SmCode AS SmCode,B.GoodCode AS GoodCode,A.SkuCode AS SkuCode,F.CfgValue AS BrandName,D.ColorName AS ColorName,D.SizeName AS SizeName,A.FirstUser AS FirstUser,A.FirstUseTime AS FirstUseTime,ISNULL(G.SpShortName, H.ShortName) AS TargetName,B.SmListDate AS SmListDate,A.LastUser AS LastUser,A.UseQty AS UseQty,CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS UseStatuz,A.BackQty AS BackQty,A.BackUser AS BackUser,CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS BackStatuz,A.CreateUser AS CreateUser,A.CreateTime AS CreateTime,A.ModifyUser AS ModifyUser,A.ModifyTime AS ModifyTime,A.Remark AS Remark,ROW_NUMBER() OVER (ORDER BY A.Id ASC) AS RowNum FROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)        ON A.SkuId = D.Id    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)        ON D.SmId = B.Id    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)        ON D.SmId = C.SmId           AND C.ColorId = D.ColorId    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)        ON A.StoreId = E.Id    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)        ON B.BrandId = F.Id    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)        ON A.SupplierId = G.Id    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)        ON A.CustomerId = H.Id where 1=1 And A.Statuz<>'9'  And A.Statuz <> 9) SELECT TOP 20000 * FROM MainSql WHERE 1= 1 \",\"FileName\":\"样衣借还单据20210518135341248.xlsx\",\"FileSize\":\"118.30 K\",\"ModifyTime\":\"2021-05-18T13:54:10.757\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":1,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","NewValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":\"http://localhost:8010/ExcelIE/\",\"ExecCount\":3,\"ExportCount\":208,\"ExportDurationQuery\":0.1110965,\"ExportDurationTask\":34.1753669,\"ExportDurationWrite\":0.0,\"ExportMsg\":\"导出失败：Object reference not set to an instance of an object.:34.1753669秒\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":\";WITH MainSql AS (SELECT (CASE                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN                    B.ImgUrl                ELSE                    ''            END           ) AS ImgUrl,CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END AS Statuz,E.CfgValue AS FxStore,B.SmName AS SmName,B.SmCode AS SmCode,B.GoodCode AS GoodCode,A.SkuCode AS SkuCode,F.CfgValue AS BrandName,D.ColorName AS ColorName,D.SizeName AS SizeName,A.FirstUser AS FirstUser,A.FirstUseTime AS FirstUseTime,ISNULL(G.SpShortName, H.ShortName) AS TargetName,B.SmListDate AS SmListDate,A.LastUser AS LastUser,A.UseQty AS UseQty,CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS UseStatuz,A.BackQty AS BackQty,A.BackUser AS BackUser,CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS BackStatuz,A.CreateUser AS CreateUser,A.CreateTime AS CreateTime,A.ModifyUser AS ModifyUser,A.ModifyTime AS ModifyTime,A.Remark AS Remark,ROW_NUMBER() OVER (ORDER BY A.Id ASC) AS RowNum FROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)        ON A.SkuId = D.Id    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)        ON D.SmId = B.Id    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)        ON D.SmId = C.SmId           AND C.ColorId = D.ColorId    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)        ON A.StoreId = E.Id    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)        ON B.BrandId = F.Id    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)        ON A.SupplierId = G.Id    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)        ON A.CustomerId = H.Id where 1=1 And A.Statuz<>'9'  And A.Statuz <> 9) SELECT TOP 20000 * FROM MainSql WHERE 1= 1 \",\"FileName\":\"样衣借还单据20210518135341248.xlsx\",\"FileSize\":\"118.30 K\",\"ModifyTime\":\"2021-05-18T13:58:48.6863171+08:00\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":2,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","CreateUser":"麦冬","ModifyUser":"麦冬","CreateTime":"2021-05-18T13:58:48.9330046+08:00","ModifyTime":"2021-05-18T13:58:48.9330070+08:00","TntId":"00000000-0000-0000-0000-000000000000"},"SourceContext":"UFX.EntityFrameworkCore.AutoHistory.AutoHistoryLogger","MachineName":"ABC","ThreadId":21,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:32.6576635+08:00","Level":"Information","MessageTemplate":"Starting the processing server.","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":1,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:33.0209793+08:00","Level":"Error","MessageTemplate":"Message (Name:ExcelIETopicName-topic,Group:cap.queue.ufx.excelie.httpapi.v1) can not be found subscriber.\r\n see: https://github.com/dotnetcore/CAP/issues/63","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":1,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:33.0902282+08:00","Level":"Information","MessageTemplate":"### CAP started!","Properties":{"SourceContext":"DotNetCore.CAP.Internal.Bootstrapper","MachineName":"ABC","ThreadId":1,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:33.2766653+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-J6R3o2J2UT1k3sDiWthtZQ","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:50.2664796+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":21,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:50.4001354+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":21,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:02:55.8742331+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"198","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":10,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:15.6918754+08:00","Level":"Error","MessageTemplate":"导入失败：Object reference not set to an instance of an object.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:18.2114965+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"75","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                                SET Status = 2,\r\n                                    ExportMsg = '导出失败：任务超时自动处理'\r\n                                WHERE Status = 0\r\n                                        AND CreateTime < DATEADD(MINUTE, -30, GETDATE())\r\n                                        AND Id <> '88a20795-0c11-171d-43e9-39fc8fbef796'","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":11,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:18.3699480+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":11,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:18.9937091+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"445","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:21.4808279+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394498860411932672","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Object reference not set to an instance of an object.\r\n ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at UFX.ExcelIE.Application.Contracts.Helper.ExcelIEHelper.FormatterHead(ExcelIEDto ieDto, DataTable dt, Boolean isEnToCh) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application.Contacts\\Helper\\ExcelIEHelper.cs:line 154\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 183\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 260\r\n   at lambda_method395(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Object reference not set to an instance of an object.","Source":"DotNetCore.CAP","InnerException":{"Type":"System.NullReferenceException","HResult":-2147467261,"Message":"Object reference not set to an instance of an object.","Source":"UFX.ExcelIE.Application.Contracts"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-18T14:03:21.5767819+08:00","Level":"Warning","MessageTemplate":"The 2th retrying consume a message failed. message id: 1394498860411932672","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:25.6984970+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:25.9156874+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:03:37.7536115+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"16","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":13,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:04:42.8097951+08:00","Level":"Error","MessageTemplate":"导入失败：Object reference not set to an instance of an object.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:04:44.8110244+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"System.InvalidOperationException: Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)","Properties":{"ConnectionId":"0HM8POA3K4II9","TraceIdentifier":"0HM8POA3K4II9:00000002","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II9:00000002","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":35,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.","Source":"Microsoft.Data.SqlClient"}}}
{"Timestamp":"2021-05-18T14:04:44.8110244+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"System.InvalidOperationException: Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)","Properties":{"ConnectionId":"0HM8POA3K4II5","TraceIdentifier":"0HM8POA3K4II5:00000009","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II5:00000009","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":17,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached.","Source":"Microsoft.Data.SqlClient"}}}
{"Timestamp":"2021-05-18T14:04:44.8381350+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"30","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                                SET Status = 2,\r\n                                    ExportMsg = '导出失败：任务超时自动处理'\r\n                                WHERE Status = 0\r\n                                        AND CreateTime < DATEADD(MINUTE, -30, GETDATE())\r\n                                        AND Id <> '88a20795-0c11-171d-43e9-39fc8fbef796'","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":35,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:04:44.8138256+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)\r\n   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)\r\n   at Microsoft.Data.SqlClient.TdsParserStateObject.ThrowExceptionAndWarning(Boolean callerHasConnectionLock, Boolean asyncClose)\r\n   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)\r\n   at Microsoft.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()\r\n   at Microsoft.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()\r\n   at Microsoft.Data.SqlClient.TdsParser.ConsumePreLoginHandshake(Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean& marsCapable, Boolean& fedAuthRequired)\r\n   at Microsoft.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity, Boolean withFailover, SqlAuthenticationMethod authType)\r\n   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, Boolean withFailover)\r\n   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString connectionOptions, SqlCredential credential, TimeoutTimer timeout)\r\n   at Microsoft.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(TimeoutTimer timeout, SqlConnectionString connectionOptions, SqlCredential credential, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance)\r\n   at Microsoft.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, SqlCredential credential, Object providerInfo, String newPassword, SecureString newSecurePassword, Boolean redirectedUserInstance, SqlConnectionString userConnectionOptions, SessionData reconnectSessionData, Boolean applyTransientFaultHandling, String accessToken, DbConnectionPool pool)\r\n   at Microsoft.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, DbConnectionPoolKey poolKey, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.CreatePooledConnection(DbConnectionPool pool, DbConnection owningObject, DbConnectionOptions options, DbConnectionPoolKey poolKey, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.CreateObject(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.UserCreateRequest(DbConnection owningObject, DbConnectionOptions userOptions, DbConnectionInternal oldConnection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II8","TraceIdentifier":"0HM8POA3K4II8:00000006","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II8:00000006","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":21,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8364949+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II5","TraceIdentifier":"0HM8POA3K4II5:0000000A","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II5:0000000A","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":17,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8146862+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4IIA","TraceIdentifier":"0HM8POA3K4IIA:00000004","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4IIA:00000004","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":39,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8354815+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II9","TraceIdentifier":"0HM8POA3K4II9:00000003","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II9:00000003","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8500399+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II5","TraceIdentifier":"0HM8POA3K4II5:0000000B","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II5:0000000B","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":17,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8508267+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4IIA","TraceIdentifier":"0HM8POA3K4IIA:00000005","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4IIA:00000005","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8511884+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II9","TraceIdentifier":"0HM8POA3K4II9:00000004","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II9:00000004","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8510371+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II8","TraceIdentifier":"0HM8POA3K4II8:00000007","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II8:00000007","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":39,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8557453+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II9","TraceIdentifier":"0HM8POA3K4II9:00000005","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II9:00000005","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":21,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8560854+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II8","TraceIdentifier":"0HM8POA3K4II8:00000008","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II8:00000008","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":39,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8554513+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II5","TraceIdentifier":"0HM8POA3K4II5:0000000C","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II5:0000000C","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8567067+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4IIA","TraceIdentifier":"0HM8POA3K4IIA:00000006","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4IIA:00000006","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8611448+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II8","TraceIdentifier":"0HM8POA3K4II8:00000009","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II8:00000009","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8611468+08:00","Level":"Error","MessageTemplate":"Connection id \"{ConnectionId}\", Request id \"{TraceIdentifier}\": An unhandled exception was thrown by the application.","Exception":"Microsoft.Data.SqlClient.SqlException (0x80131904): Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; \r\n ---> System.ComponentModel.Win32Exception (258): 等待的操作过时。\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)\r\n   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)\r\n   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)\r\n   at Microsoft.Data.SqlClient.SqlConnection.Open()\r\n   at DotNetCore.CAP.SqlServer.DbConnectionExtensions.ExecuteReader[T](IDbConnection connection, String sql, Func`2 readerFunc, Object[] sqlParams)\r\n   at DotNetCore.CAP.SqlServer.SqlServerMonitoringApi.GetStatistics()\r\n   at DotNetCore.CAP.Dashboard.RazorPage.<Assign>b__55_0()\r\n   at System.Lazy`1.ViaFactory(LazyThreadSafetyMode mode)\r\n   at System.Lazy`1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)\r\n   at System.Lazy`1.CreateValue()\r\n   at DotNetCore.CAP.Dashboard.DashboardMetrics.<>c.<.cctor>b__9_0(RazorPage page)\r\n   at DotNetCore.CAP.Dashboard.JsonStats.Dispatch(DashboardContext context)\r\n   at DotNetCore.CAP.DashboardMiddleware.Invoke(HttpContext context)\r\n   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)\r\nClientConnectionId:81b94657-3d18-439d-b6c8-ca86d75b66be\r\nError Number:-2,State:0,Class:11","Properties":{"ConnectionId":"0HM8POA3K4II5","TraceIdentifier":"0HM8POA3K4II5:0000000D","EventId":{"Id":13,"Name":"ApplicationError"},"SourceContext":"Microsoft.AspNetCore.Server.Kestrel","RequestId":"0HM8POA3K4II5:0000000D","RequestPath":"/cap/stats","MachineName":"ABC","ThreadId":11,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"Data":{"HelpLink.ProdName":"Microsoft SQL Server","HelpLink.EvtSrc":"MSSQLServer","HelpLink.EvtID":"-2","HelpLink.BaseHelpUrl":"http://go.microsoft.com/fwlink","HelpLink.LinkId":"20476"},"HResult":-2146232060,"Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Source":"Core Microsoft SqlClient Data Provider","InnerException":{"HResult":-2147467259,"Message":"等待的操作过时。","Source":null,"NativeErrorCode":258,"ErrorCode":-2147467259,"Type":"System.ComponentModel.Win32Exception"},"Errors":[{"Source":"Core Microsoft SqlClient Data Provider","Number":-2,"State":0,"Class":11,"Server":"120.55.193.39,7477","Message":"Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=33640; handshake=4293; ","Procedure":"","LineNumber":0}],"ClientConnectionId":"81b94657-3d18-439d-b6c8-ca86d75b66be","Class":11,"LineNumber":0,"Number":-2,"Procedure":"","Server":"120.55.193.39,7477","State":0,"IsTransient":false,"SqlState":null,"ErrorCode":-2146232060,"Type":"Microsoft.Data.SqlClient.SqlException"}}}
{"Timestamp":"2021-05-18T14:04:44.8654968+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"24","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":35,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:04:44.9667264+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"66","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:04:46.1726867+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394498860411932672","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Object reference not set to an instance of an object.\r\n ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at UFX.ExcelIE.Application.Contracts.Helper.ExcelIEHelper.FormatterHead(ExcelIEDto ieDto, DataTable dt, Boolean isEnToCh) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application.Contacts\\Helper\\ExcelIEHelper.cs:line 154\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 183\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 260\r\n   at lambda_method395(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Object reference not set to an instance of an object.","Source":"DotNetCore.CAP","InnerException":{"Type":"System.NullReferenceException","HResult":-2147467261,"Message":"Object reference not set to an instance of an object.","Source":"UFX.ExcelIE.Application.Contracts"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-18T14:04:46.1773472+08:00","Level":"Warning","MessageTemplate":"The Subscriber of the message(1394498860411932672) still fails after 3th executions and we will stop retrying.","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:05:51.5825344+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"7924af56-4a83-4297-a0e1-0017e0d2859a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8POA3K4IIB:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8POA3K4IIB","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:05:51.6310435+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"17","parameters":"@__ieDto_TemplateCode_0='?' (Size = 50)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[ExecMaxCountPer], [c].[ExecSQL], [c].[ExportHead], [c].[IsDelete], [c].[MainTableSign], [c].[ModifyTime], [c].[ModifyUser], [c].[OrderField], [c].[RowVersion], [c].[Sort], [c].[SourceType], [c].[SourceUrl], [c].[Status], [c].[TemplateCode], [c].[TemplateName], [c].[TemplateType], [c].[TemplateUrl]\r\nFROM [CO_ExcelExportSQL] AS [c]\r\nWHERE [c].[TemplateCode] = @__ieDto_TemplateCode_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"7924af56-4a83-4297-a0e1-0017e0d2859a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8POA3K4IIB:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8POA3K4IIB","MachineName":"ABC","ThreadId":6,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:05:58.5249442+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"50","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"7924af56-4a83-4297-a0e1-0017e0d2859a","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8POA3K4IIB:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8POA3K4IIB","MachineName":"ABC","ThreadId":17,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:05:58.6390991+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":7379.2428,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8POA3K4IIB:00000002","ConnectionId":"0HM8POA3K4IIB","MachineName":"ABC","ThreadId":19,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"7379.2428"}]}}
{"Timestamp":"2021-05-18T14:06:12.2439677+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":40,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T14:06:12.8897364+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":50,"ProcessId":38480,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
