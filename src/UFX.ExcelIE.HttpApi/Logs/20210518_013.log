{"Timestamp":"2021-05-18T13:53:36.6577655+08:00","Level":"Information","MessageTemplate":"审计记录:{@info}","Properties":{"info":{"_typeTag":"AutoHistory","Id":"a8e6c965-a27e-3149-b6cc-39fc9036418b","ObjId":"88a20795-0c11-171d-43e9-39fc8fbef796","ObjName":"CO_ExcelExportSQLLog","Operate":"Modified","OldValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":null,\"ExecCount\":1,\"ExportCount\":0,\"ExportDurationQuery\":0.0,\"ExportDurationTask\":48.0,\"ExportDurationWrite\":0.0,\"ExportMsg\":\"导出失败：任务超时自动处理\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":null,\"FileName\":null,\"FileSize\":null,\"ModifyTime\":\"2021-05-18T11:43:51.04\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":2,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","NewValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":\"http://localhost:8010/ExcelIE/\",\"ExecCount\":2,\"ExportCount\":208,\"ExportDurationQuery\":2.1818888,\"ExportDurationTask\":50.3918169,\"ExportDurationWrite\":12.8938573,\"ExportMsg\":\"导出成功：50.3918169秒\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":\";WITH MainSql AS (SELECT (CASE                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN                    B.ImgUrl                ELSE                    ''            END           ) AS ImgUrl,CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END AS Statuz,E.CfgValue AS FxStore,B.SmName AS SmName,B.SmCode AS SmCode,B.GoodCode AS GoodCode,A.SkuCode AS SkuCode,F.CfgValue AS BrandName,D.ColorName AS ColorName,D.SizeName AS SizeName,A.FirstUser AS FirstUser,A.FirstUseTime AS FirstUseTime,ISNULL(G.SpShortName, H.ShortName) AS TargetName,B.SmListDate AS SmListDate,A.LastUser AS LastUser,A.UseQty AS UseQty,CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS UseStatuz,A.BackQty AS BackQty,A.BackUser AS BackUser,CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS BackStatuz,A.CreateUser AS CreateUser,A.CreateTime AS CreateTime,A.ModifyUser AS ModifyUser,A.ModifyTime AS ModifyTime,A.Remark AS Remark,ROW_NUMBER() OVER (ORDER BY A.Id ASC) AS RowNum FROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)        ON A.SkuId = D.Id    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)        ON D.SmId = B.Id    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)        ON D.SmId = C.SmId           AND C.ColorId = D.ColorId    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)        ON A.StoreId = E.Id    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)        ON B.BrandId = F.Id    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)        ON A.SupplierId = G.Id    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)        ON A.CustomerId = H.Id where 1=1 And A.Statuz<>'9'  And A.Statuz <> 9) SELECT TOP 20000 * FROM MainSql WHERE 1= 1 \",\"FileName\":\"样衣借还单据20210518135244707.xlsx\",\"FileSize\":\"118.30 K\",\"ModifyTime\":\"2021-05-18T13:53:29.7493376+08:00\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":1,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","CreateUser":"麦冬","ModifyUser":"麦冬","CreateTime":"2021-05-18T13:53:36.5512657+08:00","ModifyTime":"2021-05-18T13:53:36.5512694+08:00","TntId":"00000000-0000-0000-0000-000000000000"},"SourceContext":"UFX.EntityFrameworkCore.AutoHistory.AutoHistoryLogger","MachineName":"ABC","ThreadId":4,"ProcessId":29220,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:57:54.8563970+08:00","Level":"Information","MessageTemplate":"Starting the processing server.","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":1,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:57:55.2060589+08:00","Level":"Error","MessageTemplate":"Message (Name:ExcelIETopicName-topic,Group:cap.queue.ufx.excelie.httpapi.v1) can not be found subscriber.\r\n see: https://github.com/dotnetcore/CAP/issues/63","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":1,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:57:55.3300068+08:00","Level":"Information","MessageTemplate":"### CAP started!","Properties":{"SourceContext":"DotNetCore.CAP.Internal.Bootstrapper","MachineName":"ABC","ThreadId":1,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:57:55.4985320+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-zjFXctLsmaw69FZQqldBqw","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":17,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:15.4792987+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":13,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:15.4937132+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":13,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:16.1177244+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"51","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":18,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:45.0343769+08:00","Level":"Error","MessageTemplate":"导入失败：Object reference not set to an instance of an object.","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":13,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:48.9149057+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"28","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                                SET Status = 2,\r\n                                    ExportMsg = '导出失败：任务超时自动处理'\r\n                                WHERE Status = 0\r\n                                        AND CreateTime < DATEADD(MINUTE, -30, GETDATE())\r\n                                        AND Id <> '88a20795-0c11-171d-43e9-39fc8fbef796'","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":21,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:49.0600720+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"13","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":21,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:49.2679677+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"28","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":13,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:52.9077707+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394498860411932672","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Object reference not set to an instance of an object.\r\n ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at UFX.ExcelIE.Application.Contracts.Helper.ExcelIEHelper.FormatterHead(ExcelIEDto ieDto, DataTable dt, Boolean isEnToCh) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application.Contacts\\Helper\\ExcelIEHelper.cs:line 154\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 183\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 260\r\n   at lambda_method396(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":13,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Object reference not set to an instance of an object.","Source":"DotNetCore.CAP","InnerException":{"Type":"System.NullReferenceException","HResult":-2147467261,"Message":"Object reference not set to an instance of an object.","Source":"UFX.ExcelIE.Application.Contracts"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-18T13:58:52.9878054+08:00","Level":"Warning","MessageTemplate":"The 1th retrying consume a message failed. message id: 1394498860411932672","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":13,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:58.9293825+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":33,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:58:59.5007706+08:00","Level":"Information","MessageTemplate":"开始导入！","Properties":{"SourceContext":"UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService","MachineName":"ABC","ThreadId":33,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T13:59:05.1680996+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"30","parameters":"@__ieDto_TemplateLog_Id_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__ieDto_TemplateLog_Id_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":33,"ProcessId":37244,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
