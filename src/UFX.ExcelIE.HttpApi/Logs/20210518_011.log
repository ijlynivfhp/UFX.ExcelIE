{"Timestamp":"2021-05-18T11:53:23.7439462+08:00","Level":"Information","MessageTemplate":"审计记录:{@info}","Properties":{"info":{"_typeTag":"AutoHistory","Id":"e693785e-ba53-cbbc-e9ef-39fc8fc8321b","ObjId":"88a20795-0c11-171d-43e9-39fc8fbef796","ObjName":"CO_ExcelExportSQLLog","Operate":"Modified","OldValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":null,\"ExecCount\":1,\"ExportCount\":0,\"ExportDurationQuery\":0.0,\"ExportDurationTask\":48.0,\"ExportDurationWrite\":0.0,\"ExportMsg\":null,\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":null,\"FileName\":null,\"FileSize\":null,\"ModifyTime\":\"2021-05-18T11:43:51.04\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":0,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","NewValue":"{\"CreateTime\":\"2021-05-18T11:43:18.9345625+08:00\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":\"http://localhost:8010/ExcelIE/\",\"ExecCount\":1,\"ExportCount\":208,\"ExportDurationQuery\":3.6936638,\"ExportDurationTask\":29.9098217,\"ExportDurationWrite\":9.832633,\"ExportMsg\":\"导出成功：29.9098217秒\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":\";WITH MainSql AS (SELECT (CASE                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN                    B.ImgUrl                ELSE                    ''            END           ) AS ImgUrl,CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END AS Statuz,E.CfgValue AS FxStore,B.SmName AS SmName,B.SmCode AS SmCode,B.GoodCode AS GoodCode,A.SkuCode AS SkuCode,F.CfgValue AS BrandName,D.ColorName AS ColorName,D.SizeName AS SizeName,A.FirstUser AS FirstUser,A.FirstUseTime AS FirstUseTime,ISNULL(G.SpShortName, H.ShortName) AS TargetName,B.SmListDate AS SmListDate,A.LastUser AS LastUser,A.UseQty AS UseQty,CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS UseStatuz,A.BackQty AS BackQty,A.BackUser AS BackUser,CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS BackStatuz,A.CreateUser AS CreateUser,A.CreateTime AS CreateTime,A.ModifyUser AS ModifyUser,A.ModifyTime AS ModifyTime,A.Remark AS Remark,ROW_NUMBER() OVER (ORDER BY A.Id ASC) AS RowNum FROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)        ON A.SkuId = D.Id    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)        ON D.SmId = B.Id    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)        ON D.SmId = C.SmId           AND C.ColorId = D.ColorId    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)        ON A.StoreId = E.Id    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)        ON B.BrandId = F.Id    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)        ON A.SupplierId = G.Id    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)        ON A.CustomerId = H.Id where 1=1 And A.Statuz<>'9'  And A.Statuz <> 9) SELECT TOP 20000 * FROM MainSql WHERE 1= 1 \",\"FileName\":\"样衣借还单据20210518115258016.xlsx\",\"FileSize\":\"118.30 K\",\"ModifyTime\":\"2021-05-18T11:53:13.0352616+08:00\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":1,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","CreateUser":"麦冬","ModifyUser":"麦冬","CreateTime":"2021-05-18T11:53:23.5840738+08:00","ModifyTime":"2021-05-18T11:53:23.5840754+08:00","TntId":"00000000-0000-0000-0000-000000000000"},"SourceContext":"UFX.EntityFrameworkCore.AutoHistory.AutoHistoryLogger","MachineName":"ABC","ThreadId":34,"ProcessId":29912,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T11:55:09.6326881+08:00","Level":"Information","MessageTemplate":"审计记录:{@info}","Properties":{"info":{"_typeTag":"AutoHistory","Id":"ebece5c6-5bc4-f394-bf57-39fc8fc9cfc0","ObjId":"88a20795-0c11-171d-43e9-39fc8fbef796","ObjName":"CO_ExcelExportSQLLog","Operate":"Modified","OldValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":null,\"ExecCount\":1,\"ExportCount\":0,\"ExportDurationQuery\":0.0,\"ExportDurationTask\":48.0,\"ExportDurationWrite\":0.0,\"ExportMsg\":null,\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":null,\"FileName\":null,\"FileSize\":null,\"ModifyTime\":\"2021-05-18T11:43:51.04\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":0,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","NewValue":"{\"CreateTime\":\"2021-05-18T11:43:18.9345625+08:00\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":\"http://localhost:8010/ExcelIE/\",\"ExecCount\":1,\"ExportCount\":208,\"ExportDurationQuery\":0.0390298,\"ExportDurationTask\":75.1720814,\"ExportDurationWrite\":8.3566314,\"ExportMsg\":\"导出成功：75.1720814秒\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":\";WITH MainSql AS (SELECT (CASE                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN                    B.ImgUrl                ELSE                    ''            END           ) AS ImgUrl,CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END AS Statuz,E.CfgValue AS FxStore,B.SmName AS SmName,B.SmCode AS SmCode,B.GoodCode AS GoodCode,A.SkuCode AS SkuCode,F.CfgValue AS BrandName,D.ColorName AS ColorName,D.SizeName AS SizeName,A.FirstUser AS FirstUser,A.FirstUseTime AS FirstUseTime,ISNULL(G.SpShortName, H.ShortName) AS TargetName,B.SmListDate AS SmListDate,A.LastUser AS LastUser,A.UseQty AS UseQty,CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS UseStatuz,A.BackQty AS BackQty,A.BackUser AS BackUser,CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS BackStatuz,A.CreateUser AS CreateUser,A.CreateTime AS CreateTime,A.ModifyUser AS ModifyUser,A.ModifyTime AS ModifyTime,A.Remark AS Remark,ROW_NUMBER() OVER (ORDER BY A.Id ASC) AS RowNum FROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)        ON A.SkuId = D.Id    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)        ON D.SmId = B.Id    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)        ON D.SmId = C.SmId           AND C.ColorId = D.ColorId    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)        ON A.StoreId = E.Id    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)        ON B.BrandId = F.Id    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)        ON A.SupplierId = G.Id    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)        ON A.CustomerId = H.Id where 1=1 And A.Statuz<>'9'  And A.Statuz <> 9) SELECT TOP 20000 * FROM MainSql WHERE 1= 1 \",\"FileName\":\"样衣借还单据20210518115334062.xlsx\",\"FileSize\":\"118.29 K\",\"ModifyTime\":\"2021-05-18T11:54:47.9403521+08:00\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":1,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","CreateUser":"麦冬","ModifyUser":"麦冬","CreateTime":"2021-05-18T11:55:09.5881480+08:00","ModifyTime":"2021-05-18T11:55:09.5881588+08:00","TntId":"00000000-0000-0000-0000-000000000000"},"SourceContext":"UFX.EntityFrameworkCore.AutoHistory.AutoHistoryLogger","MachineName":"ABC","ThreadId":20,"ProcessId":29912,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:00:24.3417350+08:00","Level":"Information","MessageTemplate":"审计记录:{@info}","Properties":{"info":{"_typeTag":"AutoHistory","Id":"16172883-17f5-4098-a900-39fc8fce9d15","ObjId":"88a20795-0c11-171d-43e9-39fc8fbef796","ObjName":"CO_ExcelExportSQLLog","Operate":"Modified","OldValue":"{\"CreateTime\":\"2021-05-18T11:43:18.933\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":null,\"ExecCount\":1,\"ExportCount\":0,\"ExportDurationQuery\":0.0,\"ExportDurationTask\":48.0,\"ExportDurationWrite\":0.0,\"ExportMsg\":null,\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":null,\"FileName\":null,\"FileSize\":null,\"ModifyTime\":\"2021-05-18T11:43:51.04\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":0,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","NewValue":"{\"CreateTime\":\"2021-05-18T11:43:18.9345625+08:00\",\"CreateUser\":\"麦冬\",\"CreateUserId\":\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\",\"DownLoadCount\":0,\"DownLoadUrl\":\"http://localhost:8010/ExcelIE/\",\"ExecCount\":1,\"ExportCount\":208,\"ExportDurationQuery\":0.0563786,\"ExportDurationTask\":15.2078091,\"ExportDurationWrite\":8.562564,\"ExportMsg\":\"导出成功：15.2078091秒\",\"ExportParameters\":\"{\\\"Equal\\\":[],\\\"NotEqual\\\":[{\\\"FieldName\\\":[{\\\"NeckName\\\":\\\"Statuz\\\",\\\"FieldName\\\":\\\"A.Statuz\\\"}],\\\"FieldValue\\\":[\\\"9\\\"]}],\\\"Greater\\\":[],\\\"GreaterEqual\\\":[],\\\"Less\\\":[],\\\"LessEqual\\\":[],\\\"In\\\":[],\\\"NotIn\\\":[],\\\"Like\\\":[],\\\"NotLike\\\":[],\\\"CommonLike\\\":[],\\\"StartWith\\\":[],\\\"EndWith\\\":[],\\\"FitNULL\\\":[],\\\"NotFitNULL\\\":[],\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TenantId\\\":\\\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\\\",\\\"TenantCode\\\":\\\"4595\\\",\\\"TenantDBStr\\\":null,\\\"UserId\\\":\\\"ed841620-690f-43a4-b8cd-0aa1f979c6f0\\\",\\\"UserName\\\":\\\"麦冬\\\",\\\"ExportType\\\":3,\\\"IsFilterRole\\\":false,\\\"ReplaceFields\\\":{\\\"ImgUrl\\\":\\\"(CASE\\\\r\\\\n                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN\\\\r\\\\n                    B.ImgUrl\\\\r\\\\n                ELSE\\\\r\\\\n                    ''\\\\r\\\\n            END\\\\r\\\\n           )\\\"},\\\"WhereSql\\\":\\\" And A.Statuz <> 9\\\",\\\"FromSql\\\":null,\\\"Type\\\":1,\\\"Template\\\":{\\\"Id\\\":\\\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\\\",\\\"TemplateType\\\":2,\\\"TemplateCode\\\":\\\"IE20210408006\\\",\\\"TemplateName\\\":\\\"样衣借还单据\\\",\\\"TemplateUrl\\\":\\\"\\\",\\\"SourceType\\\":0,\\\"SourceUrl\\\":\\\"\\\",\\\"ExportHead\\\":\\\"[{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Id\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Id\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"主键\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"1\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ImgUrl\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣图片\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Statuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"E.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FxStore\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"仓库\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣名称\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"样衣编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.GoodCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"GoodCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"货号\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.SkuCode\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SkuCode\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"Sku编码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"F.CfgValue\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BrandName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"品牌\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.ColorName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ColorName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"颜色\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"D.SizeName\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SizeName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"尺码\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.FirstUseTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"FirstUseTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"ISNULL(G.SpShortName, H.ShortName)\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"TargetName\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出目标\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"B.SmListDate\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"SmListDate\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"上市日期\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.LastUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"LastUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后经手人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.UseQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"借出数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"UseStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"库存状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackQty\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackQty\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还数量\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.BackUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"BackStatuz\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"归还状态\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.CreateTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"CreateTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"创建时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyUser\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyUser\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"最后修改人\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.ModifyTime\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"ModifyTime\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"修改时间\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"},{\\\\\\\"FieldDbName\\\\\\\":\\\\\\\"A.Remark\\\\\\\",\\\\\\\"FieldEnName\\\\\\\":\\\\\\\"Remark\\\\\\\",\\\\\\\"FieldChName\\\\\\\":\\\\\\\"备注\\\\\\\",\\\\\\\"IsHide\\\\\\\":\\\\\\\"0\\\\\\\"}]\\\",\\\"ExecSql\\\":\\\"SELECT #SelectSql#\\\\r\\\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\\\r\\\\n        ON A.SkuId = D.Id\\\\r\\\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = B.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\\\r\\\\n        ON D.SmId = C.SmId\\\\r\\\\n           AND C.ColorId = D.ColorId\\\\r\\\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\\\r\\\\n        ON A.StoreId = E.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\\\r\\\\n        ON B.BrandId = F.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\\\r\\\\n        ON A.SupplierId = G.Id\\\\r\\\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\\\r\\\\n        ON A.CustomerId = H.Id\\\",\\\"Status\\\":0,\\\"ExecMaxCountPer\\\":20000,\\\"MainTableSign\\\":\\\"A\\\",\\\"OrderField\\\":null,\\\"Sort\\\":false,\\\"IsDelete\\\":false,\\\"CreateUser\\\":\\\"\\\",\\\"CreateTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"ModifyUser\\\":\\\"\\\",\\\"ModifyTime\\\":\\\"2021-04-15 21:25:32\\\",\\\"RowVersion\\\":\\\"AAAAAACKprE=\\\"},\\\"TemplateLog\\\":{\\\"Id\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"ParentId\\\":\\\"00000000-0000-0000-0000-000000000000\\\",\\\"TemplateSql\\\":null,\\\"ExportSql\\\":null,\\\"ExportParameters\\\":null,\\\"ExportDurationWrite\\\":0.0,\\\"ExportDurationQuery\\\":0.0,\\\"ExportDurationTask\\\":0.0,\\\"Status\\\":0,\\\"ExportMsg\\\":null,\\\"DownLoadUrl\\\":null,\\\"DownLoadCount\\\":null,\\\"FileName\\\":null,\\\"FileSize\\\":null,\\\"ExportCount\\\":null,\\\"ExecCount\\\":0,\\\"TenantId\\\":null,\\\"CreateUserId\\\":null,\\\"CreateUser\\\":null,\\\"CreateTime\\\":null,\\\"ModifyUser\\\":null,\\\"ModifyTime\\\":null,\\\"RowVersion\\\":null},\\\"WriteWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"QueryWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"TaskWatch\\\":{\\\"IsRunning\\\":false,\\\"Elapsed\\\":\\\"00:00:00\\\",\\\"ElapsedMilliseconds\\\":0,\\\"ElapsedTicks\\\":0},\\\"LocalUrl\\\":\\\"http://localhost:8010/\\\",\\\"ExportObj\\\":{},\\\"FieldList\\\":null,\\\"IsDataInit\\\":false}\",\"ExportSql\":\";WITH MainSql AS (SELECT (CASE                WHEN CHARINDEX('HTTP', ISNULL(B.ImgUrl, '')) + CHARINDEX('ftp', ISNULL(B.ImgUrl, '')) > 0 THEN                    B.ImgUrl                ELSE                    ''            END           ) AS ImgUrl,CASE A.Statuz     WHEN 9 THEN     '已作废'     ELSE     (CASE     WHEN     (     A.UseStatuz = 1     AND A.BackQty = 0     AND A.BackStatuz = 0     ) THEN     '待归还'     ELSE     (CASE     WHEN     (     A.BackQty > 0     AND A.BackQty < A.UseQty     AND A.UseStatuz = 1     ) THEN     '部分归还'     ELSE     (CASE     WHEN     (     A.BackQty = A.UseQty     AND A.BackStatuz = 1     ) THEN     '已归还'     ELSE     '未生效'     END     )     END     )     END     )     END AS Statuz,E.CfgValue AS FxStore,B.SmName AS SmName,B.SmCode AS SmCode,B.GoodCode AS GoodCode,A.SkuCode AS SkuCode,F.CfgValue AS BrandName,D.ColorName AS ColorName,D.SizeName AS SizeName,A.FirstUser AS FirstUser,A.FirstUseTime AS FirstUseTime,ISNULL(G.SpShortName, H.ShortName) AS TargetName,B.SmListDate AS SmListDate,A.LastUser AS LastUser,A.UseQty AS UseQty,CASE A.UseStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS UseStatuz,A.BackQty AS BackQty,A.BackUser AS BackUser,CASE A.BackStatuz            WHEN 0 THEN                '未生效'            ELSE                '已生效'        END AS BackStatuz,A.CreateUser AS CreateUser,A.CreateTime AS CreateTime,A.ModifyUser AS ModifyUser,A.ModifyTime AS ModifyTime,A.Remark AS Remark,ROW_NUMBER() OVER (ORDER BY A.Id ASC) AS RowNum FROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)        ON A.SkuId = D.Id    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)        ON D.SmId = B.Id    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)        ON D.SmId = C.SmId           AND C.ColorId = D.ColorId    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)        ON A.StoreId = E.Id    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)        ON B.BrandId = F.Id    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)        ON A.SupplierId = G.Id    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)        ON A.CustomerId = H.Id where 1=1 And A.Statuz<>'9'  And A.Statuz <> 9) SELECT TOP 20000 * FROM MainSql WHERE 1= 1 \",\"FileName\":\"样衣借还单据20210518115823425.xlsx\",\"FileSize\":\"118.29 K\",\"ModifyTime\":\"2021-05-18T11:58:34.2920497+08:00\",\"ModifyUser\":\"麦冬\",\"ParentId\":\"38f24c5a-c1c2-115a-0a14-39fbc2806a13\",\"Status\":1,\"TemplateSql\":\"SELECT #SelectSql#\\r\\nFROM dbo.SM_SampleStoreUse AS A WITH (NOLOCK)\\r\\n    INNER JOIN dbo.SM_SampleClothingSku AS D WITH (NOLOCK)\\r\\n        ON A.SkuId = D.Id\\r\\n    INNER JOIN dbo.SM_SampleClothing AS B WITH (NOLOCK)\\r\\n        ON D.SmId = B.Id\\r\\n    LEFT OUTER JOIN dbo.SM_SampleClothingSkc AS C WITH (NOLOCK)\\r\\n        ON D.SmId = C.SmId\\r\\n           AND C.ColorId = D.ColorId\\r\\n    INNER JOIN dbo.FX_BasicData AS E WITH (NOLOCK)\\r\\n        ON A.StoreId = E.Id\\r\\n    LEFT OUTER JOIN dbo.FX_BasicData AS F WITH (NOLOCK)\\r\\n        ON B.BrandId = F.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Supplier AS G WITH (NOLOCK)\\r\\n        ON A.SupplierId = G.Id\\r\\n    LEFT OUTER JOIN dbo.DB_Customer AS H WITH (NOLOCK)\\r\\n        ON A.CustomerId = H.Id\",\"TenantId\":\"2bd2f7b6-4b74-42b8-aa2a-8cec0027cf98\"}","CreateUser":"麦冬","ModifyUser":"麦冬","CreateTime":"2021-05-18T12:00:24.3096642+08:00","ModifyTime":"2021-05-18T12:00:24.3096709+08:00","TntId":"00000000-0000-0000-0000-000000000000"},"SourceContext":"UFX.EntityFrameworkCore.AutoHistory.AutoHistoryLogger","MachineName":"ABC","ThreadId":18,"ProcessId":29912,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:16.7048684+08:00","Level":"Information","MessageTemplate":"Starting the processing server.","Properties":{"SourceContext":"DotNetCore.CAP.Processor.CapProcessingServer","MachineName":"ABC","ThreadId":1,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:16.9585998+08:00","Level":"Information","MessageTemplate":"### CAP started!","Properties":{"SourceContext":"DotNetCore.CAP.Internal.Bootstrapper","MachineName":"ABC","ThreadId":1,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:17.1927768+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-kk97ZeZkCWhmybl-rKl4SQ","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:19.1856672+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","ActionId":"bacb71b7-dccb-4507-80fb-262a593d9c0c","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8PM6T3ACG1:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8PM6T3ACG1","MachineName":"ABC","ThreadId":31,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:21.6591033+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"58","parameters":"@__ieDto_TemplateCode_0='?' (Size = 50)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[ExecMaxCountPer], [c].[ExecSQL], [c].[ExportHead], [c].[IsDelete], [c].[MainTableSign], [c].[ModifyTime], [c].[ModifyUser], [c].[OrderField], [c].[RowVersion], [c].[Sort], [c].[SourceType], [c].[SourceUrl], [c].[Status], [c].[TemplateCode], [c].[TemplateName], [c].[TemplateType], [c].[TemplateUrl]\r\nFROM [CO_ExcelExportSQL] AS [c]\r\nWHERE [c].[TemplateCode] = @__ieDto_TemplateCode_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"bacb71b7-dccb-4507-80fb-262a593d9c0c","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8PM6T3ACG1:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8PM6T3ACG1","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:30.3216660+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"39","parameters":"@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (Size = 50), @p3='?' (DbType = Guid), @p4='?' (Size = 500), @p5='?' (Precision = 18) (DbType = Decimal), @p6='?' (Precision = 18) (DbType = Decimal), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Size = 200), @p9='?' (Size = 8000) (DbType = AnsiString), @p10='?' (Size = 8000) (DbType = AnsiString), @p11='?' (Size = 200), @p12='?' (Size = 50), @p13='?' (DbType = DateTime), @p14='?' (Size = 50), @p15='?' (DbType = Guid), @p16='?' (Size = 1) (DbType = Byte), @p17='?' (Size = 8000) (DbType = AnsiString), @p18='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nINSERT INTO [CO_ExcelExportSQLLog] ([Id], [CreateTime], [CreateUser], [CreateUserId], [DownLoadUrl], [ExportDurationQuery], [ExportDurationTask], [ExportDurationWrite], [ExportMsg], [ExportParameters], [ExportSQL], [FileName], [FileSize], [ModifyTime], [ModifyUser], [ParentId], [Status], [TemplateSQL], [TenantId])\r\nVALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18);\r\nSELECT [DownLoadCount], [ExecCount], [ExportCount], [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p0;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","ActionId":"bacb71b7-dccb-4507-80fb-262a593d9c0c","ActionName":"UFX.ExcelIE.HttpApi.Controllers.HomeController.PushExcelExportMsg (UFX.ExcelIE.HttpApi)","RequestId":"0HM8PM6T3ACG1:00000002","RequestPath":"/Home/PushExcelExportMsg","ConnectionId":"0HM8PM6T3ACG1","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:02:30.4812302+08:00","Level":"Information","MessageTemplate":"HTTP {RequestMethod} {RequestPath} responded {StatusCode} in {Elapsed:0.0000} ms","Properties":{"RequestMethod":"POST","RequestPath":"/Home/PushExcelExportMsg","StatusCode":200,"Elapsed":13048.7867,"SourceContext":"Serilog.AspNetCore.RequestLoggingMiddleware","RequestId":"0HM8PM6T3ACG1:00000002","ConnectionId":"0HM8PM6T3ACG1","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"},"Renderings":{"Elapsed":[{"Format":"0.0000","Rendering":"13048.7867"}]}}
{"Timestamp":"2021-05-18T12:03:01.1650798+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394503637992632320","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: Object reference not set to an instance of an object.\r\n ---> System.NullReferenceException: Object reference not set to an instance of an object.\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 245\r\n   at lambda_method776(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":32,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"Object reference not set to an instance of an object.","Source":"DotNetCore.CAP","InnerException":{"Type":"System.NullReferenceException","HResult":-2147467261,"Message":"Object reference not set to an instance of an object.","Source":"UFX.ExcelIE.Application"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-18T12:03:01.2210549+08:00","Level":"Warning","MessageTemplate":"The 1th retrying consume a message failed. message id: 1394503637992632320","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":32,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:03:22.7489549+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":32,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:03:22.8164836+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"59","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:03:22.9084601+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"15","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:03:23.3263621+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"383","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":31,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:12.6435942+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"8","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:12.6733134+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"9","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:12.7059134+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"22","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":18,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:22.4208340+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"38","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"UPDATE CO_ExcelExportSQLLog\r\n                    SET Status = 2,\r\n                        ExportMsg = '导出失败：任务超时自动处理'\r\n                    WHERE Status = 0\r\n                          AND CreateTime < DATEADD(MINUTE, -30, GETDATE());","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":32,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:22.4544878+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"32","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":32,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:22.4857058+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"19","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:04:59.9540138+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"25","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:05:00.0029789+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"39","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:05:31.0608616+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"25","parameters":"@__get_Item_0='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT TOP(1) [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]\r\nWHERE [c].[Id] = @__get_Item_0","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":17,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:05:31.1126478+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"36","parameters":"@p21='?' (DbType = Guid), @p0='?' (DbType = DateTime), @p1='?' (Size = 50), @p2='?' (DbType = Guid), @p3='?' (Size = 1) (DbType = Byte), @p4='?' (Size = 500), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 18) (DbType = Decimal), @p8='?' (Precision = 18) (DbType = Decimal), @p9='?' (Precision = 18) (DbType = Decimal), @p10='?' (Size = 200), @p11='?' (Size = 8000) (DbType = AnsiString), @p12='?' (Size = 8000) (DbType = AnsiString), @p13='?' (Size = 200), @p14='?' (Size = 50), @p15='?' (DbType = DateTime), @p16='?' (Size = 50), @p17='?' (DbType = Guid), @p22='?' (Size = 8) (DbType = Binary), @p18='?' (Size = 1) (DbType = Byte), @p19='?' (Size = 8000) (DbType = AnsiString), @p20='?' (DbType = Guid)","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SET NOCOUNT ON;\r\nUPDATE [CO_ExcelExportSQLLog] SET [CreateTime] = @p0, [CreateUser] = @p1, [CreateUserId] = @p2, [DownLoadCount] = @p3, [DownLoadUrl] = @p4, [ExecCount] = @p5, [ExportCount] = @p6, [ExportDurationQuery] = @p7, [ExportDurationTask] = @p8, [ExportDurationWrite] = @p9, [ExportMsg] = @p10, [ExportParameters] = @p11, [ExportSQL] = @p12, [FileName] = @p13, [FileSize] = @p14, [ModifyTime] = @p15, [ModifyUser] = @p16, [ParentId] = @p17, [Status] = @p18, [TemplateSQL] = @p19, [TenantId] = @p20\r\nWHERE [Id] = @p21 AND [RowVersion] = @p22;\r\nSELECT [RowVersion]\r\nFROM [CO_ExcelExportSQLLog]\r\nWHERE @@ROWCOUNT = 1 AND [Id] = @p21;","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":18,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:07:04.6427868+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:08:45.5664816+08:00","Level":"Information","MessageTemplate":"Executed DbCommand ({elapsed}ms) [Parameters=[{parameters}], CommandType='{commandType}', CommandTimeout='{commandTimeout}']{newLine}{commandText}","Properties":{"elapsed":"23","parameters":"","commandType":"Text","commandTimeout":30,"newLine":"\r\n","commandText":"SELECT [c].[Id], [c].[CreateTime], [c].[CreateUser], [c].[CreateUserId], [c].[DownLoadCount], [c].[DownLoadUrl], [c].[ExecCount], [c].[ExportCount], [c].[ExportDurationQuery], [c].[ExportDurationTask], [c].[ExportDurationWrite], [c].[ExportMsg], [c].[ExportParameters], [c].[ExportSQL], [c].[FileName], [c].[FileSize], [c].[ModifyTime], [c].[ModifyUser], [c].[ParentId], [c].[RowVersion], [c].[Status], [c].[TemplateSQL], [c].[TenantId]\r\nFROM [CO_ExcelExportSQLLog] AS [c]","EventId":{"Id":20101,"Name":"Microsoft.EntityFrameworkCore.Database.Command.CommandExecuted"},"SourceContext":"Microsoft.EntityFrameworkCore.Database.Command","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:14:31.7876307+08:00","Level":"Warning","MessageTemplate":"RabbitMQ client connection closed! --> Unexpected Exception","Properties":{"SourceContext":"DotNetCore.CAP.RabbitMQ.ConnectionChannelPool","MachineName":"ABC","ThreadId":6,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:14:31.8951652+08:00","Level":"Warning","MessageTemplate":"RabbitMQ consumer cancelled. --> amq.ctag-kk97ZeZkCWhmybl-rKl4SQ","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":6,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:14:31.8955595+08:00","Level":"Warning","MessageTemplate":"RabbitMQ consumer shutdown. --> Unexpected Exception","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":6,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:14:35.9705253+08:00","Level":"Error","MessageTemplate":"An exception occurred while executing the subscription method. Topic:ExcelIETopicName-topic, Id:1394498860411932672","Exception":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException: The instance of entity type 'CoExcelExportSqllog' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.\r\n ---> System.InvalidOperationException: The instance of entity type 'CoExcelExportSqllog' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)\r\n   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)\r\n   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)\r\n   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Update(TEntity entity)\r\n   at UFX.EntityFrameworkCore.UnitOfWork.Repository`1.UpdateAsync(TEntity entity)\r\n   at UFX.ExcelIE.Domain.Services.ExcelIE.ExcelIEDomainService.EditAsyncExcelLogModel(CoExcelExportSqllog excelLog, Boolean isDelExpire) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Domain\\Services\\ExcelIE\\ExcelIEDomainService.Command.cs:line 20\r\n   at UFX.ExcelIE.Application.Services.ExcelIE.ExcelIEService.ExcelExport(ExcelIEDto ieDto) in E:\\Project\\UFX.ExcelIE-master\\src\\UFX.ExcelIE.Application\\Services\\ExcelIE\\ExcelIEService.cs:line 256\r\n   at lambda_method776(Closure , Object )\r\n   at Microsoft.Extensions.Internal.ObjectMethodExecutorAwaitable.Awaiter.GetResult()\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.ExecuteWithParameterAsync(ObjectMethodExecutor executor, Object class, Object[] parameter)\r\n   at DotNetCore.CAP.Internal.SubscribeInvoker.InvokeAsync(ConsumerContext context, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   --- End of inner exception stack trace ---\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.InvokeConsumerMethodAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)\r\n   at DotNetCore.CAP.Internal.SubscribeDispatcher.ExecuteWithoutRetryAsync(MediumMessage message, ConsumerExecutorDescriptor descriptor, CancellationToken cancellationToken)","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator","ExceptionDetail":{"HResult":-2146233088,"Message":"The instance of entity type 'CoExcelExportSqllog' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.","Source":"DotNetCore.CAP","InnerException":{"Type":"System.InvalidOperationException","HResult":-2146233079,"Message":"The instance of entity type 'CoExcelExportSqllog' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.","Source":"Microsoft.EntityFrameworkCore"},"Type":"DotNetCore.CAP.Internal.SubscriberExecutionFailedException"}}}
{"Timestamp":"2021-05-18T12:14:35.9744491+08:00","Level":"Warning","MessageTemplate":"The 1th retrying consume a message failed. message id: 1394498860411932672","Properties":{"SourceContext":"DotNetCore.CAP.Internal.SubscribeDispatcher","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:15:14.3587842+08:00","Level":"Warning","MessageTemplate":"Transport connection is unhealthy, reconnection...","Properties":{"SourceContext":"DotNetCore.CAP.Processor.TransportCheckProcessor","MachineName":"ABC","ThreadId":6,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:15:21.6892012+08:00","Level":"Information","MessageTemplate":"Entity Framework Core {version} initialized '{contextType}' using provider '{provider}' with options: {options}","Properties":{"version":"5.0.5","contextType":"SCMExcelIEContext","provider":"Microsoft.EntityFrameworkCore.SqlServer","options":"None","EventId":{"Id":10403,"Name":"Microsoft.EntityFrameworkCore.Infrastructure.ContextInitialized"},"SourceContext":"Microsoft.EntityFrameworkCore.Infrastructure","MachineName":"ABC","ThreadId":4,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
{"Timestamp":"2021-05-18T12:15:24.5109507+08:00","Level":"Information","MessageTemplate":"RabbitMQ consumer registered. --> amq.ctag-L6eYSCai8jhHOKr_sAmEmQ","Properties":{"SourceContext":"DotNetCore.CAP.Internal.ConsumerRegister","MachineName":"ABC","ThreadId":79,"ProcessId":20012,"ProcessName":"UFX.ExcelIE.HttpApi","EnvironmentUserName":"ABC\\Administrator"}}
